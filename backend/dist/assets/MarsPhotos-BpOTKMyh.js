import{r as a,c as v,l as T,j as e,I as A,M,b as N,i as x,m as b}from"./main-CgJZUh7x.js";const F={date:""};function Y(){const[m,U]=a.useState(F),[o,u]=a.useState([]),[d,g]=a.useState(v(T)),[j,R]=a.useState("0"),[D,C]=a.useState(""),[I,P]=a.useState(!1),[y,q]=a.useState(""),[E,S]=a.useState(!1),c=a.useRef(0);function w(l){var n;l.preventDefault(),l.stopPropagation(),console.log("Form submitted.");const r=l.currentTarget,t={date:((n=new FormData(r).get("date"))==null?void 0:n.toString())||""};x(m,t)||U(t),P(!0),S(!1),g(v(T)),b(t,!0).then(s=>{P(!1),S(!0),g(s),console.log(s.totalPhotos),s.photoUrls.length&&(R(s.photoUrls.length.toString()),C(s.totalPhotos)),console.log(s,t,s.photoUrls.length);const i=[];if(s.error!==""){const h=e.jsx("div",{id:"mp-error",children:e.jsx("p",{id:"mp-error-info",children:s.error.split(`
`).map((p,f)=>e.jsxs("span",{children:[p,e.jsx("br",{})]},f))})},"MP-ERROR-ELEMENT");i.push(h),u([...i]),console.error("ENCOUNTERED ERROR IN USEEFFECT",...i);return}for(let h=0;h<Math.min(s.photoUrls.length,20);h++){const p=s.photoIds[h],f=s.photoUrls[h];i.push(e.jsx("article",{className:"mp-photo-tile",children:e.jsx("img",{src:f,alt:`A photo captured by the Curiosity rover. Photo id: ${p}`,className:"mp-photo-tile-img"})},p))}console.log(o,i),x(o,i)||(u(i),console.log("YAY",o,i)),c.current===0&&(c.current+=20)})}function O(l=20){console.warn("TRIGGERED!",c.current+l),b(m,!1).then(r=>{g(r),r.photoUrls.length&&R(r.photoUrls.length.toString()),console.log(r,m,r.totalPhotos);const t=[];if(console.log(r.error),r.error!==""){t.push(...o),t.pop(),t.push(e.jsx("div",{id:"mp-error",children:e.jsx("p",{id:"mp-error-info",children:r.error.split(`
`).map((n,s)=>e.jsxs("span",{children:[n,e.jsx("br",{})]},s))})},"MP-ERROR-ELEMENT")),u([...t]),console.error("ENCOUNTERED ERROR IN LOADMORE",...t);return}for(let n=0;n<Math.min(l+c.current,r.photoUrls.length);n++){const s=r.photoIds[n],i=r.photoUrls[n];t.push(e.jsx("article",{className:"mp-photo-tile",children:e.jsx("img",{src:i,alt:`A photo captured by the Curiosity rover. Photo id: ${s}`,className:"mp-photo-tile-img"})},s))}c.current+=l,console.log(o,t,c.current),x(o,t)||(u(t),console.log(o,t))})}function k(){const l=new Date,r=l.getFullYear();let t=(l.getMonth()+1).toString(),n=l.getDate().toString();return parseInt(n)<10&&(n="0"+n),parseInt(t)<10&&(t="0"+t),r+"-"+t+"-"+n}return y===""&&q(k()),console.log(!!d.error,d.photoUrls.length!==o.length,o),e.jsxs("div",{id:"MarsPhotos",children:[e.jsx("h1",{id:"mp-heading",children:"Mars Rover Photos"}),e.jsxs("p",{id:"mp-desc",children:["See some of the most awe-inspiring pictures taken by NASA's Curiosity rover - operational since 9/7/2012.",e.jsx("br",{}),e.jsx("br",{}),"Total photos taken: ",D||"~702642"]}),e.jsx("form",{id:"mp-form",method:"POST",onSubmit:w,children:e.jsxs("fieldset",{id:"mpf-fieldset",children:[e.jsx("legend",{id:"mpf-fieldset-legend",children:"  Select a date:  "}),e.jsx("div",{id:"mpf-date-container",children:e.jsx("input",{type:"date",id:"mpf-date",name:"date",min:"2012-08-06",max:y,defaultValue:"2015-06-03",required:!0})}),e.jsx("button",{id:"mpf-submit-btn",type:"submit",children:"Submit"})]})}),I&&!E?e.jsx("div",{className:"loader"}):o.length>0&&E?e.jsxs("div",{id:"mp-results",children:[d.error!==""?o.length>1?e.jsxs("p",{id:"mp-results-total",children:["Curiosity took ",j," photos that day:"]}):null:e.jsxs("p",{id:"mp-results-total",children:["Curiosity took ",j," photos that day:"]}),e.jsx(A,{next:O,hasMore:d.photoUrls.length!==o.length&&!d.error,children:d.error?o.length===1?o:e.jsx(M,{columnsCountBreakPoints:{320:1,550:2,900:3,1200:4},children:e.jsx(N,{gutter:"2em",children:o})}):e.jsx(M,{columnsCountBreakPoints:{320:1,550:2,900:3,1200:4},children:e.jsx(N,{gutter:"2em",children:o})}),loader:e.jsx("div",{className:"loader"}),dataLength:o.length,scrollThreshold:.8})]}):null]})}export{Y as default};
